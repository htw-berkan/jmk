<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <title>Session Status Test</title>
</head>
<body>
<script>
    AFRAME.registerComponent('session-status', {
        init: function () {
            const sceneEl = this.el.sceneEl;
            var arjsscript = document.createElement('script');

            // Event-Listener fÃ¼r AR und VR
            sceneEl.addEventListener('enter-ar', () => {
                console.log('Entered AR mode');
            });

            sceneEl.addEventListener('enter-vr', (qualifiedName, value) => {
                console.log('Entered VR mode');
                if (sceneEl.is('vr-mode')) {
                    console.log("Current session: VR mode");
                } else if (sceneEl.is('ar-mode')) {
                    console.log("Current session: AR mode");
                    arjsscript.setAttribute('src','https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.min.js');
                    document.head.appendChild(arjsscript);
                    console.log("AR.js added!");
                } else {
                    console.log("Current session: No active XR mode");
                }
            });

            sceneEl.addEventListener('exit-ar', () => {
                console.log('Exited AR mode');

            });

            sceneEl.addEventListener('exit-vr', () => {
                console.log('Exited VR mode');
                document.head.removeChild(arjsscript);
            });
        }
    });
</script>

<a-scene session-status xr-mode-ui="enabled: true; XRMode: xr;">
    <!-- Loading assets -->
    <a-assets>
        <a-asset-item id="jmk" src="assets/jmk-head.glb"></a-asset-item>
        <img id="sky" src="assets/jmk-bg.svg">
    </a-assets>

    <!-- Skybox for VR only -->
    <a-sky hide-on-enter-ar src="#sky" repeat="10 10" transparent="true"></a-sky>

    <!-- 3D Model -->
    <a-entity id="ar-model" gltf-model="#jmk"
              scale="0.5 0.5 0.5"
              position="0 1.5 -1"
              shadow="cast: true; receive: false">
    </a-entity>
</a-scene>
</body>
</html>
