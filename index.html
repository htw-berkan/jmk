<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <title>Jemek Jemowit</title>
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico">
    <style>
    </style>
</head>
<body>
<script>
    AFRAME.registerComponent('smooth-look-at', {
        schema: {
            target: { type: 'selector' }, // Ziel, auf das geschaut wird
            lerpFactor: { type: 'number', default: 0.1 } // Interpolationsfaktor
        },

        init: function () {
            this.targetPosition = new THREE.Vector3();
            this.currentQuaternion = new THREE.Quaternion();
            this.targetQuaternion = new THREE.Quaternion();
        },

        tick: function () {
            const targetEl = this.data.target;
            if (!targetEl) return;

            // Zielposition abrufen
            targetEl.object3D.getWorldPosition(this.targetPosition);

            // Richtung berechnen
            this.el.object3D.lookAt(this.targetPosition);

            // Zielrotation erfassen
            this.targetQuaternion.copy(this.el.object3D.quaternion);

            // Aktuelle Rotation interpolieren
            this.currentQuaternion.slerp(this.targetQuaternion, this.data.lerpFactor);

            // Interpolierte Rotation setzen
            this.el.object3D.quaternion.copy(this.currentQuaternion);
        }
    });



    AFRAME.registerComponent('sound-control', {
        schema: {
            target: { type: 'selector' } // Das Ziel-Sound-Entity
        },

        init: function () {
            const soundEntity = this.data.target;

            if (!soundEntity) {
                console.error('Sound-Control: Kein Ziel-Sound-Entity angegeben!');
                return;
            }

            this.el.addEventListener('click', () => {
                const soundComponent = soundEntity.components.sound;
                if (!soundComponent) {
                    console.error('Sound-Control: Ziel hat keine Sound-Komponente!');
                    return;
                }

                if (soundComponent.isPlaying) {
                    soundComponent.pauseSound();
                    console.log('Sound pausiert');
                } else {
                    soundComponent.playSound();
                    console.log('Sound abgespielt');
                }
            });
        }
    });

</script>
<a-scene
        id="scene"
        vr-mode-ui="enabled: false">

    <!-- Assets -->
    <a-assets>
        <a-asset-item id="jmk" src="assets/jmk-head.glb"></a-asset-item>
        <img id="sky-bg" src="assets/jmk-bg.svg">
        <audio id="bg-noise" src="assets/WarteschleifeAnnabellxJemek.mp3" preload="auto"></audio>
        <a-asset-item id="radio-obj" src="assets/radio/Radio.obj"></a-asset-item>
        <a-asset-item id="radio-mtl" src="assets/radio/Radio.mtl"></a-asset-item>
        <a-asset-item id="table-corona-obj" src="assets/tisch/Tv_Table_Corona_Obj.obj"></a-asset-item>
        <a-asset-item id="tafel-objekt" src="assets/gltf/signboard.gltf"></a-asset-item>
        <a-asset-item id="tv-obj" src="assets/tv/Old_Tv_Set_nr1.obj"></a-asset-item>
        <a-asset-item id="tv-mtl" src="assets/tv/Old_Tv_Set-nr1.mtl"></a-asset-item>
        <video id="bigos-vid" autoplay loop="true" src="assets/bigos.mp4"></video>
    </a-assets>

    <!-- Camera and Stuff -->
    <a-camera
            id="dev-camera"
            active="true"
            position="0 1.6 0"
            look-controls="enabled:true"
            wasd-controls="enabled:true">
        <a-cursor
                id="cursor"
                material="color: yellow; shader: flat"
                position="0 0 -1">
        </a-cursor>
    </a-camera>

    <!-- Controller -->
    <a-entity
            id="controller-left"
            laser-controls="hand: left"
            line="color: red; opacity: 0.75">
    </a-entity>
    <a-entity
            id="controller-right"
            laser-controls="hand: right"
            line="color: red; opacity: 0.75">
    </a-entity>



    <!-- Basic Scene -->

    <!-- Scene Sky -->
    <a-sky id="sky"
            src="#sky-bg"
            radius="30"
            repeat="10 10"
            transparent="true">
    </a-sky>

    <a-entity id="amLight"
            light="type: ambient; intensity: 0.1">
    </a-entity>
    <a-entity id="dirLight"
            light="type: directional; castShadow: true; intensity:0.5;"
            position=" 1 1 1">

    </a-entity>

    <a-entity id="floor"
            geometry="primitive: sphere; radius: 30;"
            scale="1 0 1"
            position="0 0 0"
            rotation="0 0 0"
            shadow="receive: true">
    </a-entity>

    <!-- Table Radio -->
    <a-entity id="table-radio-setup"
              position="2 0 -3.5"
              scale="0.75 0.75 0.75"
              rotation="0 -40 0">

        <a-entity id="table1"
                  obj-model="obj: #table-corona-obj;"
                  position="0 0 0"
                  scale="0.002 0.002 0.002"
                  shadow="cast: true; receive: false">
        </a-entity>

        <a-entity id="table2"
                  obj-model="obj: #table-vray-obj;"
                  position="0 0 0"
                  scale="0.002 0.002 0.002"
                  shadow="cast: true; receive: false">
        </a-entity>

        <a-entity id="radio"
                  class="clickable"
                  obj-model="obj: #radio-obj; mtl: #radio-mtl"
                  position=".78 1.42 0.2"
                  scale="0.001 0.001 0.001"
                  rotation="0 -10 0"
                  shadow="cast: true; receive: false">
            <!-- Sound Entity -->
            <a-entity
                    id="sound-entity"
                    sound="src: #bg-noise; autoplay: false; loop: true;">
            </a-entity>
        </a-entity>
        <a-entity id="sound-control-radio"
                  class="sound-control"
                  geometry="primitive: plane;"
                  scale="0.1 0.1"
                  material="color:#ff0000; opacity:0.5"
                  position="0.97 1.55 0.2"
                  sound-control="target: #sound-entity">
        </a-entity>

        <!-- TV -->
        <a-entity obj-model="obj: #tv-obj; mtl: #tv-mtl"
                  position="-1 1.8 0"
                  scale="1 1 1"
                  shadow="cast: true; receive: false"
                  rotation="0 10 0">
            <a-video
                    src="#bigos-vid"
                    width="4"
                    height="3"
                    position="0 0 0.295"
                    scale="0.17 0.17 0.17"></a-video>
        </a-entity>
    </a-entity>

    <a-gltf-model id="tafel"
              src="#tafel-objekt"
              position="-2 0 -4"
              scale="0.05 0.05 0.05"
              rotation="0 30 0"
              shadow="cast: true; receive: false">
    </a-gltf-model>

    <!-- Sound Control Box -->
    <a-entity id="sound-control-box"
              class="sound-control"
              geometry="primitive: plane;"
              scale="0.1 0.1"
              material="color:#ff0000"
              position="1 2 -1">
    </a-entity>

    <!-- Head Objekt -->
    <a-entity id="vr-model"
            gltf-model="#jmk"
            scale="50 50 50"
            position="0 7 -20"
            shadow="cast: true; receive: false"
            smooth-look-at="target: #dev-camera; lerpFactor: 0.05">
    </a-entity>




    <!-- Button Placeholders -->
    <a-entity hide-on-enter-vr id="buttons" position="0 2 -1">
        <a-entity class="clickable" id="#" geometry="primitive: plane;" src="#" scale="0.1 0.1" position="0 0.25 0" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="home" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="-0.25 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="about" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="-0.5 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="gigs" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="0.25 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="instagram" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="0.5 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="youtube" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="0.75 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="telegram" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="-0.75 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>

        <a-entity class="clickable" id="spotify" src="#" geometry="primitive: plane;" scale="0.1 0.1" position="0 0 0" depth="0.15" height="0.15" width="0.15" navigate-on-click="url: http://#">
        </a-entity>
    </a-entity>

</a-scene>

<!-- Clicker -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const clickables = document.getElementsByClassName('clickable');
        for (let i = 0; i < clickables.length; i++) {
            clickables[i].addEventListener('click', () => {
                console.log('clicked clicker');
            });
        }
    });
</script>
</body>
</html>
